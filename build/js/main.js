!function(){function e(){p.mCustomScrollbar("update").mCustomScrollbar("scrollTo","bottom",{scrollInertia:10,timeout:0})}function a(){d=new Date,u!=d.getMinutes()&&(u=d.getMinutes(),u<10&&(u="0"+u),$('<div class="timestamp">'+d.getHours()+":"+u+"</div>").appendTo($(".message:last")),$('<div class="checkmark-sent-delivered">&check;</div>').appendTo($(".message:last")),$('<div class="checkmark-read">&check;</div>').appendTo($(".message:last")))}function s(){var s=$(".message-input").val();return""!==$.trim(s)&&($('<div class="message message-personal">'+s+"</div>").appendTo($(".mCSB_container")).addClass("new"),a(),$(".message-input").val(null),e(),void setTimeout(function(){n(l)},1e3+20*Math.random()*100))}function t(){$('<div class="message loading new"><figure class="avatar"><img src="http://askavenue.com/img/17.jpg" /></figure><span></span></div>').appendTo($(".mCSB_container")),e()}function i(s){t(),setTimeout(function(){$(".message.loading").remove(),$('<div class="message new"><figure class="avatar"><img src="http://askavenue.com/img/17.jpg" /></figure>'+s+"</div>").appendTo($(".mCSB_container")).addClass("new"),a(),e()},1e3+20*Math.random()*100)}function n(s){t(),setTimeout(function(){$(".message.loading").remove(),s.appendTo($(".mCSB_container")).addClass("new"),a(),e()},1e3+20*Math.random()*100)}function o(e){var a=$(e).serialize();$.ajax({type:"POST",url:"../mail.php",data:a,success:function(e){console.log("форма отправлена"+e),i("Спасибо! Мы скоро с вами свяжемся!")},error:function(e,a){console.log("Возникла ошибка: "+e.responseCode)}})}function m(){$(".messages-wrap").slideToggle().css("display","flex"),$(".messenger").toggleClass("active"),$(".messenger").hasClass("active")?i("Чего надобно?"):$(".mCSB_container").empty()}$("head").append("<link rel='stylesheet' type='text/css' href='css/main.css'/>");var l=$('<div class="message new"><figure class="avatar"><img src="http://askavenue.com/img/17.jpg" /></figure>Как вам удобнее получить ответ?<form action="" id="answer"><input type="radio" name="how" id="email"><label for="email">По email </label><input type="radio" name="how" id="tel"><label for="tel">По телефону </label><input type="submit" value="Ответить"></form></div>'),r=$('<div class="message new"><figure class="avatar"><img src="http://askavenue.com/img/17.jpg" /></figure>Оставьте свое имя и email и мы вам ответим<form action="" id="email-form"><input type="text" name="name" id="name" placeholder="Введите ваше имя" required pattern="[A-Za-z]+"><input type="email" name="email" id="email" placeholder="Введите ваш email" required><input type="submit" value="Ответить"></form></div>'),c=$('<div class="message new"><figure class="avatar"><img src="http://askavenue.com/img/17.jpg" /></figure>Оставьте свое имя и номер телефона и мы вам позвоним<form action="" id="tel-form"><input type="text" name="name" id="name" placeholder="Введите ваше имя" required pattern="[A-Za-z]+"><input type="tel" name="tel" id="tel" placeholder="Введите ваш телефон" required pattern="[0-9]+"><input type="submit" value="Ответить"></form></div>');$(".messenger").html('<div class="menu"><div class="button">...</div></div><div class="chat"><div class="chat-title"><figure class="avatar"><img src="http://askavenue.com/img/17.jpg" /></figure><div><h1>Аристарх Сигизмундович</h1><h2>Консультант</h2></div></div><div class="messages-wrap"><div class="messages"><div class="messages-content"></div></div><div class="message-box"><textarea type="text" class="message-input" placeholder="Type message..."></textarea><button type="submit" class="message-submit">Send</button></div></div></div>');var d,u,p=$(".messages-content"),g=setTimeout(function(){m()},5e3);$(window).load(function(){p.mCustomScrollbar()}),$(".message-submit").click(function(){s()}),$(window).on("keydown",function(e){if(13===e.which)return s(),!1}),$("body").on("submit","#answer",function(e){var a=$('#answer input[id="email"]'),s=$('#answer input[id="tel"]');a.is(":checked")?n(r):s.is(":checked")?n(c):(i("Может попробуем еще раз?"),setTimeout(function(){n(l)},500)),e.preventDefault()}),$("body").on("submit","#email-form",function(e){e.preventDefault(),o("#email-form")}),$("body").on("submit","#tel-form",function(e){e.preventDefault(),o("#tel-form")}),$(".button").click(function(){clearTimeout(g),m()})}();